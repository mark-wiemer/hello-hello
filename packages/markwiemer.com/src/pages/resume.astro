---
import Layout from "@/layouts/Layout.astro";
import "@/assets/resume.css";

const colophonId = "colophon";
const rowClass = "row";

type Entry = {
  title: string;
  dates: [string, string];
  bullets: string[];
};

interface ExperienceEntry extends Entry {
  organization: string;
}

interface ProjectEntry extends Entry {
  description: string;
  url: string;
  organization: string;
}

const experience: ExperienceEntry[] = [
  {
    title: "Software Engineer II",
    organization: "Microsoft",
    dates: ["March 2024", "present"],
    bullets: [
      "Delivered 4 AI-powered apps using Semantic Kernel, Copilot Studio, and Declarative Agents for M365 Copilot",
      "Reduced data access time from days to seconds across core scenarios",
      "Decreased time to competency for Technical Support Engineers by 50%",
    ],
  },
  {
    title: "Software Engineer",
    organization: "Microsoft",
    dates: ["August 2020", "March 2024"],
    bullets: [
      "Delivered React app for 200+ administrators to upload, target, and combine 10,000+ trainings",
      "Rebuilt intuitive end-to-end learning path experience for 250,000+ learners",
      "Ensured WCAG 2.1 AA accessibility compliance across dozens of webpages from design onward",
    ],
  },
  {
    title: "Software Engineering Intern",
    organization: "Bloomberg L.P.",
    dates: ["May 2019", "July 2019"],
    bullets: [
      "Used Jenkins, Docker, and pytest in new CI pipeline",
      "Reduced dev loop time from hours to minutes",
    ],
  },
];

const volunteering: ExperienceEntry[] = [
  {
    title: "Volunteer",
    organization: "Bridge Disability Ministries",
    dates: ["December 2025", "present"],
    bullets: [
      "Helped with general cleaning and assisted with activities at social events for disabled adults",
    ],
  },
  {
    title: "Court Appointed Special Advocate (CASA)",
    organization: "King County Superior Court",
    dates: ["October 2025", "present"],
    bullets: [
      "Advocated for the best interests of children removed from their homes",
      "Reviewed 1,000+ pages of court documents, conducted monthly interviews, and testified in court",
    ],
  },
  {
    title: "Big Brother",
    organization: "Big Brothers Big Sisters of Puget Sound",
    dates: ["February 2021", "present"],
    bullets: [
      "Befriended my Little Brother, serving as role model and #1 fan",
      "Continued relationship to present day after ending formal program in September 2025",
    ],
  },
];

const projects: ProjectEntry[] = [
  {
    title: "AHK++",
    description: "VS Code language extension",
    url: "https://ahkpp.com",
    organization: "",
    dates: ["November 2020", "present"],
    bullets: [
      "Added automated tests and new features to deprecated language support extension",
      "Acquired 420,000+ installs with a 4.8/5.0 rating across 28 reviews",
    ],
  },
  {
    title: "Mocha",
    description: "JavaScript testing framework",
    url: "https://mochajs.org",
    organization: "",
    dates: ["August 2025", "present"],
    bullets: [
      "Reviewed community-led PRs and issues across critical components",
      "Maintained 12,000,000+ weekly downloads and 22,000+ GitHub stars",
    ],
  },
];
---

<script define:vars={{ id: colophonId }} is:inline>
  function equalizeColophonElWidths() {
    const left = document.getElementById(`${id}-left`);
    const right = document.getElementById(`${id}-right`);
    if (!left || !right) return;

    // Reset widths to auto to measure natural sizes
    left.style.width = "auto";
    right.style.width = "auto";

    // add a small buffer to prevent wrapping
    const maxWidth = Math.max(left.offsetWidth, right.offsetWidth) + 2;
    left.style.width = `${maxWidth}px`;
    right.style.width = `${maxWidth}px`;
  }

  document.addEventListener("DOMContentLoaded", equalizeColophonElWidths);
  window.addEventListener("resize", equalizeColophonElWidths);
</script>

<Layout pageTitle="Resume" klass="resume" showFooter={false}>
  <h1>Mark Wiemer</h1>
  <div id={colophonId}>
    <span id={`${colophonId}-left`}><a href="/">markwiemer.com</a></span>
    <p>February 2026</p>
    <p id={`${colophonId}-right`}>markwiemer at outlook ðŸ¤“</p>
  </div>

  <hr />

  <h2>Education</h2>
  <div class={rowClass}>
    <p><b>University of Wisconsin-Madison</b></p>
    <p><b>Graduated:</b> May 2020</p>
  </div>
  <div class={rowClass}>
    <p><b>Bachelor of Science:</b> Computer Science, Mathematics</p>
    <p><b>GPA:</b> 4.0/4.0</p>
  </div>
  <div class={rowClass}>
    <p><b>Certificate (Minor):</b> French</p>
    <!-- empty cell for alignment -->
    <p></p>
  </div>

  <hr />

  <h2>Experience</h2>
  {
    experience.map((exp) => (
      <>
        <div class={rowClass}>
          <p>
            <b>{exp.title}</b> ({exp.organization})
          </p>
          <p>{`${exp.dates[0]} â€“ ${exp.dates[1]}`}</p>
        </div>
        <ul>
          {exp.bullets.map((bullet) => (
            <li>{bullet}</li>
          ))}
        </ul>
      </>
    ))
  }

  <hr />

  <h2>Projects</h2>
  {
    projects.map((project) => (
      <>
        <div class={rowClass}>
          <p>
            <b>
              <a href={project.url}>{project.title}</a>
            </b>{" "}
            ({project.description})
          </p>
          <p>{`${project.dates[0]} â€“ ${project.dates[1]}`}</p>
        </div>
        <ul>
          {project.bullets.map((bullet) => (
            <li>{bullet}</li>
          ))}
        </ul>
      </>
    ))
  }

  <hr />

  <h2>Volunteering</h2>
  {
    volunteering.map((vol) => (
      <>
        <div class={rowClass}>
          <p>
            <b>{vol.title}</b> ({vol.organization})
          </p>
          <p>{`${vol.dates[0]} â€“ ${vol.dates[1]}`}</p>
        </div>
        <ul>
          {vol.bullets.map((bullet) => (
            <li>{bullet}</li>
          ))}
        </ul>
      </>
    ))
  }
</Layout>
